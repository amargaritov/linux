diff --git a/mm/memory.c b/mm/memory.c
index dbee35dfc14a..a6dcbc41e3cf 100644
--- a/mm/memory.c
+++ b/mm/memory.c
@@ -81,6 +81,8 @@
 
 #include "internal.h"
 
+#define ENABLE_RES  
+
 #if defined(LAST_CPUPID_NOT_IN_PAGE_FLAGS) && !defined(CONFIG_COMPILE_TEST)
 #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid.
 #endif
@@ -3191,11 +3193,17 @@ static vm_fault_t do_anonymous_page(struct vm_fault *vmf)
 	if (unlikely(anon_vma_prepare(vma)))
 		goto oom;
 
+#ifdef ENABLE_RES
 	page = khugepaged_get_reserved_page(vma, vmf->address);
+#else
+  page = NULL;
+#endif // ENABLE_RES
 	if (!page) {
 		// Try to reserve pages
+#ifdef ENABLE_RES
 		khugepaged_reserve(vma, vmf->address); //Artemiy changed
 		page = khugepaged_get_reserved_page(vma, vmf->address);
+#endif // ENABLE_RES
 		if (!page) {
 			// Allocate one page
 			page = alloc_zeroed_user_highpage_movable(vma, vmf->address);
